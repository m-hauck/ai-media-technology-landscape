"use strict";(()=>{var g=document.querySelector("dialog"),P=document.querySelector("dialog #modal-close-button"),h={name:"Name",manufacturer:"Company",highlightProduct:"Highlight product",logo:"Logo",link:"Link",mediatype:"Media type",description:"Description",technologyReadinessLevel:"Technology Readiness Level",aiTechnologiesUsed:"AI technologies used",categories:"Categories",paymentModel:"Payment Model",companyLocation:"Company headquarters",funding:"Funding",revenuePerYear:"Revenue",notes:"Notes"};function H(e){return e.split(",").map(t=>t.trim().charAt(0).toUpperCase()+t.trim().slice(1)).join(", ")}function q(e){return e.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function b(){let e=document.querySelector("#modal #modal-grid");for(let[t,o]of Object.entries(h)){if(t=="logo")continue;let n=document.createElement("div");n.dataset[t+"Name"]="",n.innerText=o,e?.appendChild(n);let r=document.createElement("div");r.dataset[t+"Content"]="",e?.appendChild(r)}}function u(e,t){let o=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();g.querySelector(`[data-${o}-content]`).innerText=e.getAttribute(`data-${o}`)??"";let n="initial";(e.getAttribute(`data-${o}`)==null||e.getAttribute(`data-${o}`)=="")&&(n="none"),g.querySelector(`[data-${o}-name]`).style.display=n,g.querySelector(`[data-${o}-content]`).style.display=n}function L(e,t){if(e==null||!(e instanceof HTMLElement))return;let o=document.querySelector("#modal");for(let[n,r]of Object.entries(h))switch(n){case"logo":o.querySelector("[data-logo]").src=`img/${e.getAttribute("data-logo")}`;break;case"link":o.querySelector("[data-link-content]").innerHTML=`<a href="${e.getAttribute("data-link")}" target="_blank" title="Open external link to '${e.getAttribute("data-name")}'">${e.getAttribute("data-link")}</a>`;break;case"mediatype":e.dataset.mediatype=H(e.getAttribute("data-mediatype")),u(e,n);break;case"technologyReadinessLevel":e.dataset.technologyReadinessLevel=q(e.getAttribute("data-technology-readiness-level")),u(e,n);break;case"categories":if(e.dataset.categoriesUpdated!=null){u(e,n);break}let a=e.getAttribute("data-categories").split(","),s=[];a.forEach(l=>{let[m,d]=l.split("_");s.push(t[m].description),d&&s.push(t[m].subcategories[d].description)}),e.dataset.categories=s.join(", "),e.dataset.categoriesUpdated="true",u(e,n);break;case"paymentModel":if(e.dataset.paymentModelUpdated!=null){u(e,n);break}let i=e.getAttribute("data-payment-model").split(",");e.dataset.paymentModel=p[e.getAttribute("data-payment-model")];let c=[];i.forEach(l=>{c.push(p[l])}),e.dataset.paymentModel=c.join(", "),e.dataset.paymentModelUpdated="true",u(e,n);break;default:u(e,n)}o.showModal()}function f(e){(e.target===g||e.target instanceof HTMLElement&&e.target.id==="modal-close-button")&&g.close()}function k(){g.addEventListener("click",f),P.addEventListener("click",f)}k();var p={free:"Free",freemium:"Freemium","paid-once":"Paid once","paid-with-premium-extra":"Paid with premium extras","paid-periodically":"Paid periodically","contact-for-pricing":"Contact for Pricing"};function v(){let e=document.querySelectorAll(".product");e.forEach(o=>{o.style.minHeight="0px"});let t=0;e.forEach(o=>{let n=o.getBoundingClientRect().height;n>t&&(t=n)}),e.forEach(o=>{o.style.minHeight=`${t}px`})}function A(e){if(e==null)return{};let t=Object.keys(e).sort((n,r)=>n.localeCompare(r)),o={};return t.forEach(n=>{o[n]=e[n]}),o}function E(e){return new Promise((t,o)=>{let n=new XMLHttpRequest;n.onreadystatechange=()=>{n.readyState===XMLHttpRequest.DONE&&(n.status!==200&&o(),t(JSON.parse(n.responseText)))},n.open("GET",e,!0),n.send()})}function C(e){let t=document.querySelectorAll(`${e} .product:not([style*='display: none'])`),o=new Set;return t.forEach(n=>{let r=n.dataset.name,a=n.dataset.manufacturer;o.add(`${a} ${r}`)}),o.size.toString()}function M(e){for(let[t]of Object.entries(e))document.querySelector(`#${t} .count-product`).innerText=C(`#${t}`);document.querySelector("#count-number").innerText=C("#row-products")}function $(){document.querySelector("#counter-total")?.classList.remove("invisible"),document.querySelector("#unavailable-products-switch")?.classList.remove("invisible")}function x(e,t){t.forEach(o=>{o.categories.forEach(r=>{let[a,s]=r.split("_");o.technologyReadinessLevelClass=o.technologyReadinessLevel==null?"trl-unknown":`trl-${o.technologyReadinessLevel}`,o.mediatypeClass=o.mediatype.length>1?"mediatype-mixed":`mediatype-${o.mediatype}`,s!=null?e[a].subcategories[s].products.push(o):e[a].products.push(o)})})}function S(e,t){e.sort((o,n)=>{let r=o[t].toString().toLowerCase(),a=n[t].toString().toLowerCase();return r<a?-1:r>a?1:0})}function w(e){for(let[t,o]of Object.entries(e)){S(e[t].products,"name");let n=o.subcategories;for(let[r,a]of Object.entries(n))S(n[r].products,"name")}}function T(e,t,o){if(t==null)return;let n=document.querySelector("#product-template");e.forEach(a=>{let s=n.content.cloneNode(!0),i=s.querySelector("li"),c=s.querySelector("img"),l=s.querySelector(".product-manufacturer"),m=s.querySelector(".product-name");i.classList.add(a.technologyReadinessLevelClass,a.mediatypeClass),c.alt=a.name,c.src=`img/${a.logo}`,a.name!=a.manufacturer&&(l.innerText=a.manufacturer),m.innerText=a.name,a.productAvailable=="false"&&i.classList.add("product-unavailable"),a.highlightProduct=="yes"&&i.classList.add("product-highlight"),a.paymentModel.forEach(d=>{let y=document.createElement("div");y.classList.add("payment-model"),y.innerText=p[d],s.querySelector(".product-content").appendChild(y)});for(let[d,y]of Object.entries(a))a.hasOwnProperty(d)&&(i.dataset[d]=a[d].toString());t.append(s)}),document.querySelectorAll(".product").forEach(a=>{a.addEventListener("click",s=>{L(s.currentTarget,o)})})}function O(e){for(let[t]of Object.entries(e)){let o=`
        <div class="category" id="${t}">
            <h2 class="category-header">
                ${e[t].description} <span class="counter-text"><span class="count-product">0</span> products</span>
            </h2>
            <ul class="product-list" id="list-${t}"></ul>
        </div>`;document.querySelector("#row-products").innerHTML+=o,T(e[t].products,document.querySelector(`#${t} ul`),e);let n=e[t].subcategories,r=A(n);for(let[a,s]of Object.entries(r)){let i=document.createElement("div");i.classList.add("subcategory","card-subtitle","mb-2","text-muted"),i.id=a,document.querySelector(`#${t}`)?.appendChild(i);let c=document.createElement("h3");c.classList.add("subcategory-header"),c.innerText=s.description,i.appendChild(c);let l=document.createElement("ul");l.classList.add("product-list"),l.id=a,document.querySelector(`#${t} #${a}`)?.appendChild(l),T(e[t].subcategories[a].products,document.querySelector(`#${t} #${a} .product-list`),e)}$()}}function R(e){let t=document.querySelector("#unavailable-products-switch .switch input"),o=document.querySelectorAll(".product-unavailable");t?.addEventListener("change",()=>{let n="";t.checked?n="flex":n="none",o.forEach(r=>{r.style.display=n}),M(e)})}function _(){let e=document.querySelector("#product-information-switch .switch input"),t=document.querySelectorAll(".product");e?.addEventListener("change",()=>{t.forEach(o=>{o.classList.toggle("product-information-hidden")}),v()})}console.clear();Promise.all([E("data/categories.json"),E("data/products.json")]).then(e=>{let[t,o]=e;t==null||o==null||(x(t,o),w(t),O(t),M(t),b(),v(),R(t),_())}).catch(e=>console.error(`Could not load values. ${e.stack}`));})();
